# API版本，apps/v1 用于 Deployment
apiVersion: apps/v1
# 资源类型为 Deployment
kind: Deployment
metadata:
  # Deployment 的名称
  name: nginx-deployment
spec:
  # 期望运行的 Pod 副本数量
  replicas: 2
  selector:
    # 标签选择器，用于关联 Pod
    matchLabels:
      app: nginx
  template:
    metadata:
      # Pod 的标签，必须与上面的 matchLabels 匹配
      labels:
        app: nginx
    spec:
      # 定义 Pod 中的容器
      containers:
      - name: nginx
        # 使用的容器镜像
        image: nginx:1.25
        # 容器监听的端口
        ports:
        - containerPort: 80

---

# API版本，v1 用于 Service
apiVersion: v1
# 资源类型为 Service
kind: Service
metadata:
  # Service 的名称
  name: nginx-service
spec:
  # Service 的类型，NodePort 会在每个节点上暴露一个端口
  type: NodePort
  selector:
    # 将流量转发到具有此标签的 Pod
    app: nginx
  ports:
    # Service 监听的端口配置
    - protocol: TCP
      # Service 自身的端口
      port: 80
      # 转发到 Pod 的目标端口
      targetPort: 80
      # 在节点上暴露的端口（范围通常是 30000-32767）
      # 如果不指定，K3s 会自动分配一个
      nodePort: 30080